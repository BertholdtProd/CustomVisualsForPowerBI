{"visual":{"name":"simpleBarChart","displayName":"Simple Bar Chart","guid":"PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96_DEBUG","visualClassName":"Visual","version":"1.0.0","description":"","supportUrl":"","gitHubUrl":""},"apiVersion":"1.1.0","author":{"name":"","email":""},"assets":{"icon":"assets/icon.png"},"externalJS":[],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Category Data","name":"category","kind":0},{"displayName":"Measure Data","name":"measure","kind":1}],"dataViewMappings":[{"conditions":[{"category":{"max":1},"measure":{"max":1}}],"categorical":{"categories":{"for":{"in":"category"},"dataReductionAlgorithm":{"top":{}}},"values":{"select":[{"bind":{"to":"measure"}}]}}}]},"content":{"js":"var powerbi;\r\n(function (powerbi) {\r\n    var extensibility;\r\n    (function (extensibility) {\r\n        var visual;\r\n        (function (visual) {\r\n            var PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96;\r\n            (function (PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96) {\r\n                var Visual = (function () {\r\n                    function Visual(options) {\r\n                        this.margin = { top: 20, right: 20, bottom: 200, left: 70 };\r\n                        console.log(\"constructor\");\r\n                        this.svg = d3.select(options.element).append('svg');\r\n                        this.g = this.svg.append('g');\r\n                        this.myVisualProp = false;\r\n                    }\r\n                    Visual.prototype.update = function (options) {\r\n                        console.log(\"update execuring...\");\r\n                        var categorical = options.dataViews[0].categorical;\r\n                        console.log(JSON.stringify(categorical));\r\n                        if (typeof categorical.categories === \"undefined\" || typeof categorical.values === \"undefined\") {\r\n                            console.log(\"abc\");\r\n                            this.g.selectAll(\"g\").remove();\r\n                            console.log(\"xyz\");\r\n                            return;\r\n                        }\r\n                        //this.myVisualProp = options.dataViews[0].metadata.objects[\"myCustomObj\"][\"myprop\"];\r\n                        // \"this\" changes inside nested functions\r\n                        // create outerThis variable to use inside nested functions\r\n                        var outerThis = this;\r\n                        // get height and width from viewport\r\n                        this.svg.attr({\r\n                            height: options.viewport.height,\r\n                            width: options.viewport.width });\r\n                        var gHeight = options.viewport.height - outerThis.margin.top - outerThis.margin.bottom;\r\n                        var gWidth = options.viewport.width - outerThis.margin.right - outerThis.margin.left;\r\n                        this.g.attr({ height: gHeight, width: gWidth });\r\n                        this.g.attr('transform', 'translate(' + outerThis.margin.left + ',' + outerThis.margin.top + ')');\r\n                        // convert data format\r\n                        var dataResult = Visual.converter(options.dataViews[0].categorical);\r\n                        // setup d3 scale\r\n                        var xScale = d3.scale.ordinal()\r\n                            .domain(dataResult.map(function (d) { return d.Category; }))\r\n                            .rangeRoundBands([0, gWidth], 0.1);\r\n                        var yMax = d3.max(dataResult, function (d) { return d.Value + 10; });\r\n                        var yScale = d3.scale.linear()\r\n                            .domain([0, yMax])\r\n                            .range([gHeight, 0]);\r\n                        // remove exsisting axis and bar\r\n                        this.svg.selectAll('.axis').remove();\r\n                        this.svg.selectAll('.bar').remove();\r\n                        // draw x axis\r\n                        var xAxis = d3.svg.axis()\r\n                            .scale(xScale)\r\n                            .orient('bottom');\r\n                        this.g\r\n                            .append('g')\r\n                            .attr('class', 'x axis')\r\n                            .style('fill', 'black') // you can get from metadata\r\n                            .attr('transform', 'translate(0,' + (gHeight - 1) + ')')\r\n                            .call(xAxis)\r\n                            .selectAll('text') // rotate text\r\n                            .style('text-anchor', 'end')\r\n                            .attr('dx', '-.8em')\r\n                            .attr('dy', '-.6em')\r\n                            .attr('transform', 'rotate(-90)');\r\n                        // draw y axis\r\n                        var formatValue = d3.format(\".2s\");\r\n                        var yAxis = d3.svg.axis()\r\n                            .scale(yScale)\r\n                            .orient('left')\r\n                            .tickFormat(function (d) { return formatValue(d); });\r\n                        this.g\r\n                            .append('g')\r\n                            .attr('class', 'y axis')\r\n                            .style('fill', 'black') // you can get from metadata\r\n                            .call(yAxis);\r\n                        // draw bar\r\n                        var shapes = this.g\r\n                            .append('g')\r\n                            .selectAll('.bar')\r\n                            .data(dataResult);\r\n                        shapes.enter()\r\n                            .append('rect')\r\n                            .attr('class', 'bar')\r\n                            .attr('fill', 'green')\r\n                            .attr('stroke', 'black')\r\n                            .attr('x', function (d) {\r\n                            return xScale(d.Category);\r\n                        })\r\n                            .attr('width', xScale.rangeBand())\r\n                            .attr('y', function (d) {\r\n                            return yScale(d.Value);\r\n                        })\r\n                            .attr('height', function (d) {\r\n                            return gHeight - yScale(d.Value);\r\n                        });\r\n                        shapes\r\n                            .exit()\r\n                            .remove();\r\n                    };\r\n                    Visual.prototype.enumerateObjectInstances = function (options) {\r\n                        console.log(\"enumerateObjectInstances\");\r\n                        var objectName = options.objectName;\r\n                        var objectEnumeration = [];\r\n                        switch (objectName) {\r\n                            case 'enableAxis':\r\n                                objectEnumeration.push({\r\n                                    objectName: objectName,\r\n                                    properties: {\r\n                                        show: true,\r\n                                    },\r\n                                    selector: null\r\n                                });\r\n                                break;\r\n                        }\r\n                        ;\r\n                        return objectEnumeration;\r\n                    };\r\n                    Visual.prototype.destroy = function () { };\r\n                    Visual.converter = function (cat) {\r\n                        var resultData = [];\r\n                        for (var i = 0; i < cat.categories[0].values.length; i++) {\r\n                            resultData.push({ Category: cat.categories[0].values[i], Value: cat.values[0].values[i] });\r\n                        }\r\n                        resultData.sort(function (x, y) { return y.Value - x.Value; });\r\n                        return resultData;\r\n                    };\r\n                    return Visual;\r\n                }());\r\n                PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96.Visual = Visual;\r\n            })(PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96 = visual.PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96 || (visual.PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96 = {}));\r\n        })(visual = extensibility.visual || (extensibility.visual = {}));\r\n    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));\r\n})(powerbi || (powerbi = {}));\r\nvar powerbi;\r\n(function (powerbi) {\r\n    var visuals;\r\n    (function (visuals) {\r\n        var plugins;\r\n        (function (plugins) {\r\n            plugins.PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96_DEBUG = {\r\n                name: 'PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96_DEBUG',\r\n                displayName: 'Simple Bar Chart',\r\n                class: 'Visual',\r\n                version: '1.0.0',\r\n                apiVersion: '1.1.0',\r\n                create: function (options) { return new powerbi.extensibility.visual.PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96.Visual(options); },\r\n                custom: true\r\n            };\r\n        })(plugins = visuals.plugins || (visuals.plugins = {}));\r\n    })(visuals = powerbi.visuals || (powerbi.visuals = {}));\r\n})(powerbi || (powerbi = {}));\r\n//# sourceMappingURL=visual.js.map","css":".visual-PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96_DEBUG p {\n  font-size: 20px;\n  font-weight: bold;\n}\n.visual-PBI_CV_8DD8014C_2A2B_4017_9C8E_8FD194F9DF96_DEBUG p em {\n  background: yellow;\n  padding: 5px;\n}\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="}}